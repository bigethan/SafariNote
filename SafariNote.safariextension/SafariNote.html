<html>
    <head>
        <title>SafariNote</title>
    </head>
    <body>
        <script tpe="text/javascript">
            safari.application.addEventListener("command", runCommand, false);
            safari.application.addEventListener("validate", validate, false);
            function runCommand(event)
            {
                
                if (event.command == "BigethanSafariNote") {
                    event.target.browserWindow.activeTab.page.dispatchMessage("BigethanSafariNote", '');
                }
            }
            function validate(event)
            {
                if (event.command == "BigethanSafariNote") {
                    console.log(event.target.browserWindow.activeTab.url.substr(-3));
                    event.target.disabled = !event.target.browserWindow.activeTab.url;
                    if (!event.target.disabled) {
                        event.target.disabled = event.target.browserWindow.activeTab.url.substr(-3) == 'pdf' ? true : false;
                    }
                }
            }
        </script>
    </body>
</html>